<h1>Crear Cuenta</h1>
<div class="crear-cuenta">
  <p>Bajo que rol te deseas registrar:</p>
  <div class="optButton" style="margin-bottom: 16px;">
    <button type="button"
            (click)="seleccionar('cafeteria')"
            [ngClass]="{'activo': tipo === 'cafeteria'}">Cafetería</button>
    <button type="button"
            (click)="seleccionar('comprador')"
            [ngClass]="{'activo': tipo === 'comprador'}">Comprador</button>
  </div>

  <form *ngIf="form as f" [formGroup]="f" (ngSubmit)="enviar()">
    <!-- Formulario de Cafetería -->
    <div *ngIf="tipo === 'cafeteria'">
      <div class="container">
        <input formControlName="nombreCafeteria" type="text" placeholder=" " class="form__input"
               [ngClass]="{'ng-invalid ng-touched': f.get('nombreCafeteria')?.invalid && f.get('nombreCafeteria')?.touched}" />
        <label>Nombre de la cafetería</label>
      </div>
      <div class="error-text" *ngIf="f.get('nombreCafeteria')?.invalid && f.get('nombreCafeteria')?.touched">Campo obligatorio</div>

      <div class="container">
        <input formControlName="ubicacion" type="text" placeholder=" " class="form__input"
               [ngClass]="{'ng-invalid ng-touched': f.get('ubicacion')?.invalid && f.get('ubicacion')?.touched}" />
        <label>Ubicación de la cafetería</label>
      </div>
      <div class="error-text" *ngIf="f.get('ubicacion')?.invalid && f.get('ubicacion')?.touched">Campo obligatorio</div>

      <div class="container">
        <input formControlName="horarioApertura" type="time" placeholder=" " class="form__input"
               [ngClass]="{'ng-invalid ng-touched': f.get('horarioApertura')?.invalid && f.get('horarioApertura')?.touched}" />
        <label>Horario de apertura</label>
      </div>
      <div class="error-text" *ngIf="f.get('horarioApertura')?.invalid && f.get('horarioApertura')?.touched">Campo obligatorio</div>

      <div class="container">
        <input formControlName="horarioCierre" type="time" placeholder=" " class="form__input"
               [ngClass]="{'ng-invalid ng-touched': f.get('horarioCierre')?.invalid && f.get('horarioCierre')?.touched}" />
        <label>Horario de cierre</label>
      </div>
      <div class="error-text" *ngIf="f.get('horarioCierre')?.invalid && f.get('horarioCierre')?.touched">Campo obligatorio</div>

      <div class="container">
        <input formControlName="correo" type="email" placeholder=" " class="form__input"
               [ngClass]="{'ng-invalid ng-touched': f.get('correo')?.invalid && f.get('correo')?.touched}" />
        <label>Correo electrónico (&#64;alumno.ipn.mx o &#64;gmail.com)</label>
      </div>
      <div class="error-text" *ngIf="f.get('correo')?.invalid && f.get('correo')?.touched">
        <div *ngIf="f.get('correo')?.errors?.['required']">Campo obligatorio</div>
        <div *ngIf="f.get('correo')?.errors?.['email']">Ingresa un correo válido</div>
      </div>

      <div class="container">
        <input formControlName="contrasena" type="password" placeholder=" " class="form__input"
               [ngClass]="{'ng-invalid ng-touched': f.get('contrasena')?.invalid && f.get('contrasena')?.touched}" />
        <label>Contraseña (mínimo 6 caracteres)</label>
      </div>
      <div class="error-text" *ngIf="f.get('contrasena')?.invalid && f.get('contrasena')?.touched">
        <div *ngIf="f.get('contrasena')?.errors?.['required']">Campo obligatorio</div>
        <div *ngIf="f.get('contrasena')?.errors?.['minlength']">Mínimo 6 caracteres</div>
      </div>

      <div class="container">
        <input type="file" id="imagen" (change)="onFileSelected($event)" accept="image/*" class="form__input">
        <label for="imagen">Imagen de la cafetería</label>
      </div>

      <!-- Mensaje de error general -->
      <div *ngIf="errorMessage" class="error-message">
        {{errorMessage}}
      </div>
    </div>

    <!-- Formulario de Comprador -->
    <div *ngIf="tipo === 'comprador'">
      <div class="container">
        <input formControlName="nombre" type="text" placeholder=" " class="form__input"
               [ngClass]="{'ng-invalid ng-touched': f.get('nombre')?.invalid && f.get('nombre')?.touched}" />
        <label>Nombre</label>
      </div>
      <div class="error-text" *ngIf="f.get('nombre')?.invalid && f.get('nombre')?.touched">
        Campo obligatorio
      </div>

      <div class="container">
        <input formControlName="apellidoPaterno" type="text" placeholder=" " class="form__input"
               [ngClass]="{'ng-invalid ng-touched': f.get('apellidoPaterno')?.invalid && f.get('apellidoPaterno')?.touched}" />
        <label>Apellido Paterno</label>
      </div>
      <div class="error-text" *ngIf="f.get('apellidoPaterno')?.invalid && f.get('apellidoPaterno')?.touched">
        Campo obligatorio
      </div>

      <div class="container">
        <input formControlName="apellidoMaterno" type="text" placeholder=" " class="form__input"
               [ngClass]="{'ng-invalid ng-touched': f.get('apellidoMaterno')?.invalid && f.get('apellidoMaterno')?.touched}" />
        <label>Apellido Materno (Opcional)</label>
      </div>

      <div class="container">
        <input formControlName="correo" type="email" placeholder=" " class="form__input"
               [ngClass]="{'ng-invalid ng-touched': f.get('correo')?.invalid && f.get('correo')?.touched}" />
        <label>Correo electrónico (&#64;alumno.ipn.mx o &#64;gmail.com)</label>
      </div>
      <div class="error-text" *ngIf="f.get('correo')?.invalid && f.get('correo')?.touched">
        <div *ngIf="f.get('correo')?.errors?.['required']">Campo obligatorio</div>
        <div *ngIf="f.get('correo')?.errors?.['email']">Ingresa un correo válido</div>
      </div>

      <div class="container">
        <input formControlName="contrasena" type="password" placeholder=" " class="form__input"
               [ngClass]="{'ng-invalid ng-touched': f.get('contrasena')?.invalid && f.get('contrasena')?.touched}" />
        <label>Contraseña (mínimo 6 caracteres)</label>
      </div>
      <div class="error-text" *ngIf="f.get('contrasena')?.invalid && f.get('contrasena')?.touched">
        <div *ngIf="f.get('contrasena')?.errors?.['required']">Campo obligatorio</div>
        <div *ngIf="f.get('contrasena')?.errors?.['minlength']">Mínimo 6 caracteres</div>
      </div>
    </div>

    <!-- Mensaje de error general -->
    <div *ngIf="errorMessage" class="error-message">
      {{errorMessage}}
    </div>

    <button type="submit" [disabled]="!f.valid || isLoading">
      <span *ngIf="!isLoading">Crear Cuenta</span>
      <span *ngIf="isLoading">Registrando...</span>
    </button>
  </form>
</div>
